/* -----------------------------------------------  

Site Name: Ian James Cox - Digital Designer Manchester
File: Global JS
Author: Abid Din (@craftedpixelz)
Version: 1.0
Copyright (c): Ian James Cox
  
------------------------------------------------ */

var ianJamesCox = ianJamesCox || {};
ianJamesCox.animEnd = function(e, t, n) {
    var r = (Modernizr.prefixed("animation") + "End").replace(/^ms/, "MS").replace(/^Webkit/, "webkit").replace(/^Moz.*/, "animationend");
    $(e).on(r, function() {
        $(this).removeClass(t).addClass(n)
    })
};
ianJamesCox.preload = function() {
    var e = $("#content").offset().top,
        t = $(window).height();
    $("#content").css("top", t);
    $("body").queryLoader2({
        percentage: true,
        backgroundColor: "none",
        barColor: "none",
        onComplete: function() {
            $("#intro").show();
            $("#content").delay(100).animate({
                top: e
            }, 800, "easeOutBack", function() {
                $("#nav").delay(100).animate({
                    left: "30px"
                }, 600, "easeOutBack", function() {
                    ianJamesCox.intro()
                })
            })
        }
    })
};
ianJamesCox.intro = function() {
    var e = $("#home"),
        t = $("#available");
    e.append("<span id='hand' class='spin' />");
    ianJamesCox.animEnd("#hand", "spin", "point");
    t.css("transform", "scale(1)");
    ianJamesCox.navigation.goToSection()
};
ianJamesCox.scrollpath = function() {
    var e = $.fn.scrollPath("getPath");
    e.moveTo(0, 500, {
        name: "home"
    }).lineTo(0, 1800).arc(500, 1800, 500, 1 * Math.PI, .5 * Math.PI, true).lineTo(2300, 2300).arc(2300, 2800, 500, 1.5 * Math.PI, 0, false, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#cbeebies-link"));
            $("section").find(".animated").removeClass("animated");
            $("#bug1, #bug2, #ladder").addClass("animated")
        },
        name: "cbeebies"
    }).lineTo(2800, 5e3).arc(3100, 5e3, 300, 1 * Math.PI, .5 * Math.PI, true).lineTo(3500, 5280, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#jampr-link"));
            $("section").find(".animated").removeClass("animated");
            $("#balloon, #plane").addClass("animated")
        },
        name: "jampr"
    }).arc(3600, 4975, 300, .5 * Math.PI, 0, true).lineTo(3900, 4800).arc(4400, 4800, 500, 1 * Math.PI, 1.5 * Math.PI, false, {
        rotate: -Math.PI / 2
    }).lineTo(5500, 4300, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#bbcsport-link"));
            $("section").find(".animated").removeClass("animated")
        },
        name: "bbcsport"
    }).arc(5500, 4800, 500, 1.5 * Math.PI, 0, false, {
        rotate: -Math.PI
    }).lineTo(6e3, 7e3).arc(5e3, 7e3, 1e3, 0, .5 * Math.PI, false, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#creativecup-link"));
            $("section").find(".animated").removeClass("animated");
            $("#ball").addClass("animated")
        },
        name: "creativecup"
    }).arc(5e3, 7e3, 1e3, .5 * Math.PI, 1 * Math.PI, false).lineTo(4e3, 6500).arc(3500, 6500, 500, 0, 1.5 * Math.PI, true).lineTo(1800, 6e3, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#mancskyline-link"));
            $("section").find(".animated").removeClass("animated");
            $("#clouds").addClass("animated")
        },
        name: "mancskyline"
    }).lineTo(500, 6e3).arc(500, 6500, 500, 1.5 * Math.PI, 1 * Math.PI, true, {
        rotate: -Math.PI / 2
    }).lineTo(0, 8e3).arc(500, 8e3, 500, 1 * Math.PI, .5 * Math.PI, true, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#claimsadvisory-link"));
            $("section").find(".animated").removeClass("animated")
        },
        name: "claimsadvisory"
    }).arc(500, 9e3, 500, 1.5 * Math.PI, 0, false).arc(1500, 9e3, 500, 1 * Math.PI, .5 * Math.PI, true).lineTo(3e3, 9500).arc(3e3, 10300, 800, 1.5 * Math.PI, 0, false, {
        rotate: -Math.PI,
        callback: function() {
            ianJamesCox.navigation.highlight($("#ipadhotwires-link"));
            $("section").find(".animated").removeClass("animated");
            $("#car, #streaks").addClass("animated")
        },
        name: "ipadhotwires"
    }).lineTo(3800, 11500).arc(4300, 11500, 500, 1 * Math.PI, .5 * Math.PI, true).lineTo(6e3, 12e3, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#thegatelab-link"));
            $("section").find(".animated").removeClass("animated");
            $("#ipad").addClass("animated")
        },
        name: "thegatelab"
    }).lineTo(7e3, 12e3).arc(7e3, 11200, 800, .5 * Math.PI, 0, true).arc(8200, 11200, 400, 1 * Math.PI, 1.5 * Math.PI, false).lineTo(8400, 10800, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#aboutme-link"));
            $("section").find(".animated").removeClass("animated")
        },
        name: "aboutme"
    }).arc(8600, 10300, 500, .5 * Math.PI, 0, true, {
        rotate: -Math.PI / 2
    }).lineTo(9100, 8e3, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#experience-link"));
            $("section").find(".animated").removeClass("animated")
        },
        name: "experience"
    }).lineTo(9100, 6500).arc(8300, 6500, 800, 0, 1.5 * Math.PI, true, {
        rotate: 0
    }).lineTo(7300, 5700, {
        callback: function() {
            ianJamesCox.navigation.highlight($("#contact-link"));
            $("section").find(".animated").removeClass("animated")
        },
        name: "contact"
    });
    if ($("html").is(".ie7, .ie8, .ie9, .chrome")) {
        $("#content").scrollPath({
            drawPath: false
        }).prepend("<span id='path' />")
    } else {
        $("#content").scrollPath({
            drawPath: true
        })
    }
};
ianJamesCox.navigation = function() {
    var e = $("#nav").find("a"),
        t = $(".gocontact"),
        n = $("#logo");
    return {
        init: function() {
            e.not(".bloglink").each(function() {
                var e = $(this),
                    t = e.attr("href").replace("#", "");
                e.on("click", function(e) {
                    e.preventDefault();
                    ianJamesCox.navigation.highlight($(this));
                    // clicky.log(t);
                    $.fn.scrollPath("scrollTo", t, 1400, "easeInOutSine");
                    // history.pushState(null, t, t)
                })
            });
            t.on("click", function(e) {
                e.preventDefault();
                ianJamesCox.navigation.highlight("#contact-link");
                history.pushState(null, null, "contact");
                $.fn.scrollPath("scrollTo", "contact", 1400, "easeInOutSine")
            });
            n.on("click", function(t) {
                t.preventDefault();
                e.removeClass("active");
                history.pushState(null, null, "/");
                $.fn.scrollPath("scrollTo", "home", 1400, "easeInOutSine")
            })
        },
        highlight: function(t) {
            if (!$(t).hasClass("active")) {
                if ($(t).parent().is("li")) {
                    e.removeClass("active");
                    $(t).addClass("active")
                }
            }
        },
        goToSection: function() {
            function t(e) {
                if (e !== "") {
                    $("#nav").find("a").removeClass("active");
                    $("#" + e + "-link").addClass("active");
                    $.fn.scrollPath("scrollTo", e, 1400, "easeInOutSine")
                } else {
                    $("#nav").find("a").removeClass("active");
                    $.fn.scrollPath("scrollTo", "home", 1400, "easeInOutSine")
                }
            }
            var e = location.pathname.split("/")[1];
            window.addEventListener("popstate", function(n) {
                e = location.pathname.split("/")[1];
                t(e)
            });
            t(e)
        }
    }
}();
ianJamesCox.contact = function() {
    $("#sayhello").submit(function(e) {
        e.preventDefault();
        var t = $(this).serialize(),
            n = $("#sayhello")[0].checkValidity();
        if (n === true) {
            $("#submit").val("Sending...").off();
            $.ajax({
                data: t,
                url: "index.php",
                type: "POST",
                success: function() {
                    $("#sayhello").slideUp(300, function() {
                        $(this).after("<div id='thanks' />");
                        $("#thanks").append("<h3>Message sent successfully!</h3>").append("<p>Thanks for contacting me. I'll be in touch as soon as possible.</p>").delay(100).animate({
                            top: "230px",
                            opacity: 1
                        }, 300, "easeOutBack")
                    })
                }
            })
        }
    })
};
ianJamesCox.polyfills = function() {
    Modernizr.load({
        test: Modernizr.input.required,
        nope: "resource/js/libs/h5f.min.js",
        callback: function(e, t, n) {
            H5F.setup($("#sayhello"), {
                requiredClass: "required"
            })
        }
    });
    Modernizr.load({
        test: Modernizr.backgroundsize,
        nope: "resource/js/libs/backstretch.min.js",
        callback: function(e, t, n) {
            $.backstretch("resource/images/bg-paper.jpg")
        }
    });
    Modernizr.load({
        test: Modernizr.touch,
        yep: "resource/js/libs/quo.min.js",
        callback: function(e, t, n) {
            if ($$.isMobile()) {
                $("#nav").hide().find("li:nth-child(10)").remove().end().after("<div id='info'><img src='resource/images/img-swipe.png' /><p>Swipe Left/Right</p></div>");
                var r = ".active",
                    i = null;
                $$("body").swipeLeft(function() {
                    if (i == null) {
                        $("#info").fadeOut(300);
                        $("#nav").find("a:first").click()
                    } else {
                        i = "next";
                        $(r).parent()[i]().find("a").click()
                    }
                    i = "next"
                });
                $$("body").swipeRight(function() {
                    i = "prev";
                    $(r).parent()[i]().find("a").click()
                });
                $$("body").swipeUp(function() {
                    $("#nav").find("a").removeClass("active");
                    i = null;
                    $.fn.scrollPath("scrollTo", "home", 1400, "easeInOutSine")
                })
            }
        }
    })
};
ianJamesCox.misc = function() {
    $("#ian").click(function() {
        $(this).addClass("shake");
        ianJamesCox.animEnd("#ian", "shake")
    })
};
$(function() {
    ianJamesCox.scrollpath();
    ianJamesCox.preload();
    ianJamesCox.contact();
    ianJamesCox.misc();
    ianJamesCox.polyfills();
    ianJamesCox.navigation.init()
});
